{% extends "layout.html" %}

{% set navActive = "records" %}

{% if not backLink %}
    {% set backLink      = 'javascript:history.back();' %}
{% endif %}
{% if not backText %}
    {% set backText      = 'Back'  %}
{% endif %}

{% if backLink == 'false' %}
    {% set backLink = false %}
{% endif %}

{% if backText == 'false' %}
    {% set backText = '' %}
{% endif %}


{% block pageTitle %}
  {{ pageHeading }} - {{serviceName}} - GOV.UK
{% endblock %}

{% block pageNavigation %}
  {% if backLink %}
    {{ govukBackLink({
      text: backText,
      href: backLink
    }) }}
  {% endif %}
{% endblock %}

{# Record could be set by locals, or in session data #}
{% set record = record or data.record %}
{% if not record %}
  {% set record = {} %}
{% endif %}



{% set canAmend = record.status | getAmendsAllowed %}
{# {% set showIncomplete = true %} #}


{# Used by summary cards #}
{% set recordPath = "/record/" + record.id %}

{% block content %}

  {% include "_includes/app-flash-message.html" %}

  <div class="record-header">
    <h1 class="govuk-heading-xl govuk-!-margin-bottom-0">
      {{pageHeading}}
      {{govukTag({
          text: record.status,
          classes: record.status | getStatusClass
      })}}
    </h1>
    {% if record.trn %}
      <span class="govuk-caption-l">TRN: {{record.trn}}
      </span>
    {% endif %}
  </div>

  <div class="govuk-error-summary govuk-error-summary--advisory" aria-labelledby="error-summary-title" role="alert" tabindex="-1" data-module="govuk-error-summary">
    <h2 class="govuk-error-summary__title" id="error-summary-title">
      You need to provide more details before recording an outcome
    </h2>
    <div class="govuk-error-summary__body">
      <ul class="govuk-list govuk-error-summary__list">
        <li>
          <a herf="">Confirm placement details are complete</a>
        </li>      
        <li>
          <a herf="">Provide a start date</a>
        </li>      
      </ul>
    </div>
  </div>

  {# {% set html %}
    <p class="govuk-notification-banner__heading">
      <ul class="govuk-list govuk-error-summary__list">
        <li>
          <a herf="">Confirm placement details are complete</a>
        </li>      
        <li>
          <a herf="">Provide a start date</a>
        </li>      
      </ul>
    </p>
  {% endset %}

  {{ govukNotificationBanner({
    html: html,
    titleText: 'Before you can record this trainees outcome'
  }) }} #}
    
  {# Hide the record actions ui if it's empty #}
  {% if (record.status | getCanDefer) or (record.status | getCanReinstate) %}
    <div class="record-actions">
      {% if record.status | getCanRecommendForQts %}
        {% if hasCommencementDate %}
          {{ govukButton({
            text: "Recommend trainee for QTS",
            href: referrer + '/qts/outcome-date',
            classes: "govuk-!-margin-bottom-0"
          }) }}
        {% else %}
          {{ govukInsetText({
            html: "This record is missing details",
            classes: "govuk-!-margin-0"
          }) }}
        {% endif %}
      {% elseif record.status == "Pending TRN" %}
        {{ govukInsetText({
          text: "This record is pending a TRN",
          classes: "govuk-!-margin-0"
        }) }}
      {% elseif record.status == "Deferred" %}
        {{ govukInsetText({
          text: "This record is deferred",
          classes: "govuk-!-margin-0"
        }) }}
      {% endif %}

      <div class="record-actions__links">
        {% if record.status | getCanDefer %}
          <p class="govuk-body govuk-!-margin-bottom-0"><a href="{{referrer}}/defer" class="govuk-link--no-visited-state">Defer</a> or <a href="{{referrer}}/withdraw" class="govuk-link--no-visited-state">withdraw</a> this trainee</p>
        {% elseif record.status | getCanReinstate %}
          <p class="govuk-body govuk-!-margin-bottom-0"><a href="{{referrer}}/reinstate" class="govuk-link--no-visited-state">Reinstate</a> or <a href="{{referrer}}/withdraw" class="govuk-link--no-visited-state">withdraw</a> this trainee</p>
        {% endif %}
      </div>
    </div>

    <hr class="govuk-section-break govuk-section-break--m govuk-section-break--visible">
  {% endif %}

  {% include "_includes/record-sub-nav.njk" %}

  {% block tabContent %}
    
  {% endblock %}

{% endblock %}


